# RAG Analysis - FAST TEST Configuration
# Optimized for quick testing (~5-10 minutes runtime)

# Project settings
project:
  name: "RAG-Analysis-HotpotQA-FastTest"
  description: "Fast test run for RAG analysis"
  version: "1.0.0"

# Random seed for reproducibility
seed: 42

# Dataset configuration - REDUCED FOR SPEED
dataset:
  name: "hotpot_qa"
  subset: "fullwiki"
  split: "validation"
  subset_size: 50  # Scaled for statistical power (McNemar test)
  sampling_strategy: "random"
  
# Model configuration - OPTIMIZED FOR SPEED
model:
  name: "TinyLlama/TinyLlama-1.1B-Chat-v1.0"  # Revert to TinyLlama for speed & prior gains
  device: "mps"  # Force MPS explicitly
  load_in_8bit: false  # Disabled - 8bit doesn't work well on MPS
  temperature: 0.2  # Slight variability for better F1
  top_p: 1.0
  repetition_penalty: 1.15
  max_new_tokens: 64  # Expanded for articulated grounded reasoning

# Retrieval configuration - REDUCED K VALUES
retrieval:
  encoder_model: "sentence-transformers/all-MiniLM-L6-v2"
  chunk_size: 300
  chunk_overlap: 75
  k_values: [1, 3, 5]  # Full retrieval depth sweep
  hybrid:
    enabled: true
    bm25_weight: 0.3
    dense_weight: 0.7
    bm25_top_n: 50
  reranker:
    enabled: true
    model: "cross-encoder/ms-marco-MiniLM-L-6-v2"
    top_n: 20
  context_max_sentences: 6
  sentences_per_passage: 2
  
# Evaluation configuration
evaluation:
  conditions:
    - "no_rag"
    - "rag_k1"
    - "rag_k3"
    - "rag_k5"
  
  metrics:
    - "exact_match"
    - "token_f1"
    - "hallucination_rate"
    - "retrieval_recall"
    - "mrr"
  
  statistical_tests:
    - "mcnemar"
    - "correlation"

# Paths
paths:
  data_dir: "data"
  results_dir: "results"
  logs_dir: "logs"
  checkpoints_dir: "checkpoints"
  dataset_subset: "data/hotpotqa_subset_fast.json"
  corpus: "data/corpus_fast.json"
  index: "data/faiss_index_fast.bin"
  results_csv: "results/evaluation_results_fast.csv"
  aggregated_results: "results/aggregated_metrics_fast.json"

# Experiment tracking
experiment:
  track_memory: false  # Disabled for speed
  save_predictions: true
  save_retrieved_passages: false  # Disabled to save time
  error_analysis_samples: 3  # Reduced

# Hallucination detection
hallucination:
  use_llm_judge: false
  manual_annotation_required: true
  annotation_sample_size: 20
  
# Logging
logging:
  level: "INFO"
  console: true
  file: true

# Validation rules
validation:
  enforce_citations: false
